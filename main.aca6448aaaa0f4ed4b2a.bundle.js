(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1025:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _ant_design_icons_lib_outline_BarChartOutline__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(523),_ant_design_icons_lib_outline_BarChartOutline__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_ant_design_icons_lib_outline_BarChartOutline__WEBPACK_IMPORTED_MODULE_0__);__webpack_require__.d(__webpack_exports__,"BarChartOutline",(function(){return _ant_design_icons_lib_outline_BarChartOutline__WEBPACK_IMPORTED_MODULE_0___default.a}))},1040:function(module,exports,__webpack_require__){var map={"./af":250,"./af.js":250,"./ar":251,"./ar-dz":252,"./ar-dz.js":252,"./ar-kw":253,"./ar-kw.js":253,"./ar-ly":254,"./ar-ly.js":254,"./ar-ma":255,"./ar-ma.js":255,"./ar-sa":256,"./ar-sa.js":256,"./ar-tn":257,"./ar-tn.js":257,"./ar.js":251,"./az":258,"./az.js":258,"./be":259,"./be.js":259,"./bg":260,"./bg.js":260,"./bm":261,"./bm.js":261,"./bn":262,"./bn.js":262,"./bo":263,"./bo.js":263,"./br":264,"./br.js":264,"./bs":265,"./bs.js":265,"./ca":266,"./ca.js":266,"./cs":267,"./cs.js":267,"./cv":268,"./cv.js":268,"./cy":269,"./cy.js":269,"./da":270,"./da.js":270,"./de":271,"./de-at":272,"./de-at.js":272,"./de-ch":273,"./de-ch.js":273,"./de.js":271,"./dv":274,"./dv.js":274,"./el":275,"./el.js":275,"./en-SG":276,"./en-SG.js":276,"./en-au":277,"./en-au.js":277,"./en-ca":278,"./en-ca.js":278,"./en-gb":279,"./en-gb.js":279,"./en-ie":280,"./en-ie.js":280,"./en-il":281,"./en-il.js":281,"./en-nz":282,"./en-nz.js":282,"./eo":283,"./eo.js":283,"./es":284,"./es-do":285,"./es-do.js":285,"./es-us":286,"./es-us.js":286,"./es.js":284,"./et":287,"./et.js":287,"./eu":288,"./eu.js":288,"./fa":289,"./fa.js":289,"./fi":290,"./fi.js":290,"./fo":291,"./fo.js":291,"./fr":292,"./fr-ca":293,"./fr-ca.js":293,"./fr-ch":294,"./fr-ch.js":294,"./fr.js":292,"./fy":295,"./fy.js":295,"./ga":296,"./ga.js":296,"./gd":297,"./gd.js":297,"./gl":298,"./gl.js":298,"./gom-latn":299,"./gom-latn.js":299,"./gu":300,"./gu.js":300,"./he":301,"./he.js":301,"./hi":302,"./hi.js":302,"./hr":303,"./hr.js":303,"./hu":304,"./hu.js":304,"./hy-am":305,"./hy-am.js":305,"./id":306,"./id.js":306,"./is":307,"./is.js":307,"./it":308,"./it-ch":309,"./it-ch.js":309,"./it.js":308,"./ja":310,"./ja.js":310,"./jv":311,"./jv.js":311,"./ka":312,"./ka.js":312,"./kk":313,"./kk.js":313,"./km":314,"./km.js":314,"./kn":315,"./kn.js":315,"./ko":316,"./ko.js":316,"./ku":317,"./ku.js":317,"./ky":318,"./ky.js":318,"./lb":319,"./lb.js":319,"./lo":320,"./lo.js":320,"./lt":321,"./lt.js":321,"./lv":322,"./lv.js":322,"./me":323,"./me.js":323,"./mi":324,"./mi.js":324,"./mk":325,"./mk.js":325,"./ml":326,"./ml.js":326,"./mn":327,"./mn.js":327,"./mr":328,"./mr.js":328,"./ms":329,"./ms-my":330,"./ms-my.js":330,"./ms.js":329,"./mt":331,"./mt.js":331,"./my":332,"./my.js":332,"./nb":333,"./nb.js":333,"./ne":334,"./ne.js":334,"./nl":335,"./nl-be":336,"./nl-be.js":336,"./nl.js":335,"./nn":337,"./nn.js":337,"./pa-in":338,"./pa-in.js":338,"./pl":339,"./pl.js":339,"./pt":340,"./pt-br":341,"./pt-br.js":341,"./pt.js":340,"./ro":342,"./ro.js":342,"./ru":343,"./ru.js":343,"./sd":344,"./sd.js":344,"./se":345,"./se.js":345,"./si":346,"./si.js":346,"./sk":347,"./sk.js":347,"./sl":348,"./sl.js":348,"./sq":349,"./sq.js":349,"./sr":350,"./sr-cyrl":351,"./sr-cyrl.js":351,"./sr.js":350,"./ss":352,"./ss.js":352,"./sv":353,"./sv.js":353,"./sw":354,"./sw.js":354,"./ta":355,"./ta.js":355,"./te":356,"./te.js":356,"./tet":357,"./tet.js":357,"./tg":358,"./tg.js":358,"./th":359,"./th.js":359,"./tl-ph":360,"./tl-ph.js":360,"./tlh":361,"./tlh.js":361,"./tr":362,"./tr.js":362,"./tzl":363,"./tzl.js":363,"./tzm":364,"./tzm-latn":365,"./tzm-latn.js":365,"./tzm.js":364,"./ug-cn":366,"./ug-cn.js":366,"./uk":367,"./uk.js":367,"./ur":368,"./ur.js":368,"./uz":369,"./uz-latn":370,"./uz-latn.js":370,"./uz.js":369,"./vi":371,"./vi.js":371,"./x-pseudo":372,"./x-pseudo.js":372,"./yo":373,"./yo.js":373,"./zh-cn":374,"./zh-cn.js":374,"./zh-hk":375,"./zh-hk.js":375,"./zh-tw":376,"./zh-tw.js":376};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=1040},1059:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"LoginAction",(function(){return LoginAction}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_src_components_login_button__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(127),_src_containers_uni_user__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(169);__webpack_exports__.default={title:"登录动作",component:_src_components_login_button__WEBPACK_IMPORTED_MODULE_1__.a};var LoginAction=function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_containers_uni_user__WEBPACK_IMPORTED_MODULE_2__.a,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_components_login_button__WEBPACK_IMPORTED_MODULE_1__.a,{returnUrl:location.origin+"/iframe.html?id=登录回调--login-callback-story&viewMode=story",target:"_blank"}))};LoginAction.story={name:"登录动作"},LoginAction.__docgenInfo={description:"",methods:[],displayName:"LoginAction"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/3-Login.stories.js"]={name:"LoginAction",docgenInfo:LoginAction.__docgenInfo,path:"stories/3-Login.stories.js"})},1061:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _a,extendStatics,react=__webpack_require__(0),react_default=__webpack_require__.n(react),querystring_es3=__webpack_require__(166),querystring_es3_default=__webpack_require__.n(querystring_es3),user=__webpack_require__(170),__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=(t=_.trys).length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},w=null!==(_a=window.parent)&&void 0!==_a?_a:window,handleCallback=function(){var query,tokenResult;w.opener&&w.opener.postMessage(w.location.search,w.location.origin),query=querystring_es3_default.a.parse(w.location.search.substr(1)),(tokenResult=(void 0).props.tokenResult||{token:query.t}).token&&user.a.loginByToken()(tokenResult).then((function(returnObj){return __awaiter(void 0,void 0,void 0,(function(){var returnPath;return __generator(this,(function(_a){return(returnPath=w.localStorage.getItem("returnPath"))?(w.location.href=returnPath,w.localStorage.setItem("returnPath","")):w.location.href=returnObj,[2]}))}))}))},__extends=(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),login_callback=function(_super){function Callback(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Callback,_super),Callback.prototype.componentWillUnmount=function(){},Callback.prototype.componentDidMount=function(){handleCallback()},Callback.prototype.componentDidHide=function(){},Callback.prototype.render=function(){return react_default.a.createElement("div",{className:"container"},react_default.a.createElement("p",null,"登录成功，窗口即将关闭，请稍等……"))},Callback}(react_default.a.Component);__webpack_require__.d(__webpack_exports__,"LoginCallbackStory",(function(){return LoginCallbackStory}));__webpack_exports__.default={title:"登录回调",component:login_callback};var LoginCallbackStory=function(){var token=window.parent.location.href;return react_default.a.createElement("div",null,"Token = ",token,react_default.a.createElement(login_callback,null))};LoginCallbackStory.story={name:"登录回调"},LoginCallbackStory.__docgenInfo={description:"",methods:[],displayName:"LoginCallbackStory"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/4-LoginCallback.stories.js"]={name:"LoginCallbackStory",docgenInfo:LoginCallbackStory.__docgenInfo,path:"stories/4-LoginCallback.stories.js"})},1062:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var react=__webpack_require__(0),react_default=__webpack_require__.n(react),uni_user=__webpack_require__(169),login_button=__webpack_require__(127),src_user=__webpack_require__(170),es=__webpack_require__(99),login=__webpack_require__(41),LoginStatus=Object(es.b)((function(state,ownProps){return{hasLoggedIn:null!==state.login.user,loading:state.login.loading,checking:state.login.checking}}),(function(dispatch,ownProps){return{startCheckingLoginStatus:function(){return dispatch(Object(login.d)(!0))},endCheckingLoginStatus:function(){return dispatch(Object(login.d)(!1))},setUserInfo:function(user){return dispatch(Object(login.f)(user))}}}))((function(_a){var hasLoggedIn=_a.hasLoggedIn,startCheckingLoginStatus=_a.startCheckingLoginStatus,setUserInfo=_a.setUserInfo,endCheckingLoginStatus=_a.endCheckingLoginStatus,checking=_a.checking;return Object(react.useEffect)((function(){startCheckingLoginStatus(),src_user.a.getInfo().then(setUserInfo).catch(console.error).finally(endCheckingLoginStatus)}),[]),checking?react_default.a.createElement(react_default.a.Fragment,null,"查询登陆状态中..."):hasLoggedIn?react_default.a.createElement(react_default.a.Fragment,null,"已登录"):react_default.a.createElement(login_button.a,{target:"_blank",returnUrl:location.origin+"/iframe.html?id=登录回调--login-callback-story&viewMode=story"})}));__webpack_require__.d(__webpack_exports__,"CheckLoginStatus",(function(){return CheckLoginStatus}));__webpack_exports__.default={title:"登录状态",component:LoginStatus};var CheckLoginStatus=function(){return react_default.a.createElement(uni_user.a,null,react_default.a.createElement(LoginStatus,null))};CheckLoginStatus.story={name:"检查是否已登录"},CheckLoginStatus.__docgenInfo={description:"",methods:[],displayName:"CheckLoginStatus"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/2-LoginStatus.stories.js"]={name:"CheckLoginStatus",docgenInfo:CheckLoginStatus.__docgenInfo,path:"stories/2-LoginStatus.stories.js"})},126:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getProfile}));var _helpers_proxyFetch__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(167),_helpers_storage__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(98),__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=(t=_.trys).length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},getProfile=(_helpers_proxyFetch__WEBPACK_IMPORTED_MODULE_0__.a.getInstance(),function(){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return[4,fetch("https://sso.jiwai.win/profile",{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer "+Object(_helpers_storage__WEBPACK_IMPORTED_MODULE_1__.a)()}})];case 1:return[4,_a.sent().json()];case 2:return[2,_a.sent()]}}))}))})},127:function(module,__webpack_exports__,__webpack_require__){"use strict";var login_button_a,react=__webpack_require__(0),react_default=__webpack_require__.n(react),lib_button=__webpack_require__(542),button_default=__webpack_require__.n(lib_button),querystring_es3=(__webpack_require__(953),__webpack_require__(166)),querystring_es3_default=__webpack_require__.n(querystring_es3),login=__webpack_require__(41),api=__webpack_require__(126),__assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=(t=_.trys).length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},login_popup=function(win,ssoUrl){var popup=null;function popupLogic(){try{popup.location.href}catch(ex){console.error("打开子窗口失败：",ex),popup.close(),win.alert("之前打开的窗口已关闭, 请重新点击并在新打开的窗口中重试。")}finally{popup&&popup.postMessage(ssoUrl,win.location.origin)}}return function(dispatch){window.localStorage.setItem("returnPath",win.location.pathname),dispatch(Object(login.b)());var interval=setInterval((function(){popup?popup.closed&&(dispatch(Object(login.c)()),clearInterval(interval)):clearInterval(interval)}),1e3);popup&&!popup.closed||(popup=win.open())&&popup.document.write('<html>\n  <head>\n    <title>第三方登录 我的个人中心</title>\n  </head>\n  <body>\n    <p>正在加载中, 请稍等 ……</p>\n    <script>\n      window.addEventListener(\n        "message",\n        function(event) {\n          console.log(event.data);\n\n          if (\n            event.data.indexOf("http://") === 0 ||\n            event.data.indexOf("https://") === 0 ||\n            event.data.indexOf("//") === 0\n          ) {\n            window.location.href = event.data;\n          }\n        },\n        false\n      );\n\n      window.opener.postMessage("listenerLoaded", window.location.origin);\n    <\/script>\n  </body>\n</html>\n'),win.addEventListener("message",(function(event){var _a;return __awaiter(this,void 0,void 0,(function(){var tokenResult,userInfo,returnPath,ex_1;return __generator(this,(function(_b){switch(_b.label){case 0:if(console.log("event = ",event),event.origin!==win.location.origin)return[2];if(!event.data)return[2];if("listenerLoaded"===event.data)return[2,popupLogic()];if("string"!=typeof event.data||0!==event.data.indexOf("?"))return[3,5];if(tokenResult=querystring_es3_default.a.parse(event.data.substr(1)),tokenResult=__assign(__assign({},tokenResult),{token:null!==(_a=tokenResult.token)&&void 0!==_a?_a:tokenResult.t}),console.log(tokenResult),!tokenResult.token)return[3,4];dispatch(Object(login.a)(tokenResult.token)),_b.label=1;case 1:return _b.trys.push([1,3,,4]),[4,Object(api.a)()];case 2:return userInfo=_b.sent(),dispatch(Object(login.f)(userInfo.data)),(returnPath=window.localStorage.getItem("returnPath"))&&returnPath!==window.location.pathname&&(console.log("即将跳转到：",returnPath),window.location.href=returnPath,window.localStorage.setItem("returnPath","")),[3,4];case 3:return ex_1=_b.sent(),console.error(ex_1),[3,4];case 4:return clearInterval(interval),console.log("登录完成，结果是: ",tokenResult),[2,(popup||event.source).close()];case 5:return[2]}}))}))}),!1),popupLogic()}},es=__webpack_require__(99);__webpack_require__.d(__webpack_exports__,"a",(function(){return LoginButton}));var w=null!==(login_button_a=window.parent)&&void 0!==login_button_a?login_button_a:window,LoginButton=Object(es.b)((function(state,ownProps){return{loading:state.login.loading}}),(function(dispatch,ownProps){return{dispatch:dispatch,startLogin:function(){return dispatch(Object(login.e)(!0))}}}))((function(_a){var target=_a.target,returnUrl=_a.returnUrl,startLogin=_a.startLogin,loading=_a.loading,dispatch=_a.dispatch,ssoUrl="https://sso.pa-ca.me/app/login?r="+encodeURIComponent(null!=returnUrl?returnUrl:w.location.href);return react_default.a.createElement(button_default.a,{href:ssoUrl,onClick:function(evt){startLogin(),"_blank"===target&&(evt.preventDefault(),login_popup(w,ssoUrl)(dispatch))},type:"primary",htmlType:"button",loading:loading},"登录")}))},167:function(module,__webpack_exports__,__webpack_require__){"use strict";(function(global){__webpack_require__(18),__webpack_require__(24),__webpack_require__(25),__webpack_require__(30),__webpack_require__(22),__webpack_require__(959),__webpack_require__(88),__webpack_require__(38),__webpack_require__(46),__webpack_require__(17),__webpack_require__(66),__webpack_require__(57),__webpack_require__(26),__webpack_require__(159),__webpack_require__(31),__webpack_require__(27),__webpack_require__(960);var antd_lib_message__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(539),antd_lib_message__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(antd_lib_message__WEBPACK_IMPORTED_MODULE_17__),react_intl__WEBPACK_IMPORTED_MODULE_19__=(__webpack_require__(977),__webpack_require__(1064)),__assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function sent(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},ProxyFetch=function(){function ProxyFetch(){this.headers={"Content-Type":"application/json"},this.init={credentials:"include",mode:"cors"},this.requestCount=0,this.isLoading=!1,this.loadingTimer=null,this.intl=Object(react_intl__WEBPACK_IMPORTED_MODULE_19__.a)({locale:global.locale||"zh",messages:__webpack_require__(985).messagesForLogin[global.locale||"zh"]}),this.setMessage(antd_lib_message__WEBPACK_IMPORTED_MODULE_17___default.a)}return ProxyFetch.prototype.setMessage=function(message){this.message=message},ProxyFetch.prototype.showLoading=function(){var _this=this;0===this.requestCount&&(this.loadingTimer=setTimeout((function(){_this.message.loading(_this.intl.formatMessage({id:"text-loading"}),0),_this.isLoading=!0,_this.loadingTimer=null}),1e3)),this.requestCount++},ProxyFetch.prototype.hideLoading=function(){this.requestCount--,0===this.requestCount&&(this.loadingTimer&&(clearTimeout(this.loadingTimer),this.loadingTimer=null),this.isLoading&&(this.isLoading=!1,this.message.destroy()))},ProxyFetch.getInstance=function(){return global.fetchInstance||(global.fetchInstance=new ProxyFetch),global.fetchInstance},ProxyFetch.prototype.get=function(url,params,settings){return void 0===params&&(params={}),void 0===settings&&(settings={}),__awaiter(this,void 0,void 0,(function(){var options,paramsArray_1;return __generator(this,(function(_a){switch(_a.label){case 0:return options={method:"GET"},params&&(paramsArray_1=[],Object.keys(params).forEach((function(key){if(params[key]instanceof Array){var value=params[key].map((function(item){return'"'+item+'"'}));paramsArray_1.push(key+"=["+value.join(",")+"]")}else paramsArray_1.push(key+"="+params[key])})),-1===url.search(/\?/)?url+="?"+paramsArray_1.join("&"):url+="&"+paramsArray_1.join("&")),[4,this.dofetch(url,options,settings)];case 1:return[2,_a.sent()]}}))}))},ProxyFetch.prototype.post=function(url,params,settings){return void 0===params&&(params={}),void 0===settings&&(settings={}),__awaiter(this,void 0,void 0,(function(){var options;return __generator(this,(function(_a){switch(_a.label){case 0:return(options={method:"POST"}).body=JSON.stringify(params),[4,this.dofetch(url,options,settings)];case 1:return[2,_a.sent()]}}))}))},ProxyFetch.prototype.put=function(url,params,settings){return void 0===params&&(params={}),void 0===settings&&(settings={}),__awaiter(this,void 0,void 0,(function(){var options;return __generator(this,(function(_a){switch(_a.label){case 0:return(options={method:"PUT"}).body=JSON.stringify(params),[4,this.dofetch(url,options,settings)];case 1:return[2,_a.sent()]}}))}))},ProxyFetch.prototype.delete=function(url,params,settings){return void 0===params&&(params={}),void 0===settings&&(settings={}),__awaiter(this,void 0,void 0,(function(){var options;return __generator(this,(function(_a){switch(_a.label){case 0:return(options={method:"DELETE"}).body=JSON.stringify(params),[4,this.dofetch(url,options,settings)];case 1:return[2,_a.sent()]}}))}))},ProxyFetch.prototype.dofetch=function(url,options,settings){var _this=this;void 0===settings&&(settings={});var isServer=settings.isServer,noLoading=settings.noLoading,noClientCookies=settings.noClientCookies;isServer||noLoading||this.showLoading();var init=noClientCookies?{}:this.init;return new Promise((function(resolve,reject){Promise.race([fetch(""+url,__assign(__assign({headers:_this.headers},init),options)),new Promise((function(resolve,reject){setTimeout((function(){return reject(_this.intl.formatMessage({id:"error-timeout"}))}),1e4)}))]).then((function(response){if(isServer||noLoading||_this.hideLoading(),404===response.status)reject(_this.intl.formatMessage({id:"error-not-found"}));else if(401===response.status)reject(_this.intl.formatMessage({id:"error-not-authorized"}));else if(400===response.status)reject(_this.intl.formatMessage({id:"error-bad-request"}));else if(204===response.status)resolve({success:!0});else{if(response)return response.json();resolve({success:!0})}})).then((function(json){json?(json.success,resolve(json)):reject({success:!1})})).catch((function(ex){noLoading||_this.hideLoading(),reject(_this.intl.formatMessage({id:"error-"+(ex.errmessage||(ex.message?ex.message.details||ex.message:"unknown"))}))}))}))},ProxyFetch}();__webpack_exports__.a=ProxyFetch}).call(this,__webpack_require__(13))},169:function(module,__webpack_exports__,__webpack_require__){"use strict";var react=__webpack_require__(0),react_default=__webpack_require__.n(react),es=__webpack_require__(99),redux=__webpack_require__(71),redux_thunk_es=__webpack_require__(531),login=__webpack_require__(20),__assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},INITIAL_STATE={loading:!1,user:null,checking:!0};var reducers=Object(redux.c)({login:function login_login(state,action){switch(void 0===state&&(state=INITIAL_STATE),action.type){case login.c:case login.d:return __assign(__assign({},state),{loading:!0});case login.g:return __assign(__assign({},state),{user:action.user});case login.a:case login.b:return __assign(__assign({},state),{loading:!1});case login.f:return __assign(__assign({},state),{loading:action.loading});case login.e:return __assign(__assign({},state),{checking:action.checking});default:return state}}}),composeEnhancers=redux.d,middlewares=[redux_thunk_es.a];var enhancer=composeEnhancers(redux.a.apply(void 0,middlewares)),uni_user_store=function(){return Object(redux.e)(reducers,enhancer)}();__webpack_exports__.a=function(_a){var children=_a.children;return react_default.a.createElement(es.a,{store:uni_user_store},children)}},170:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__(18),__webpack_require__(24),__webpack_require__(25),__webpack_require__(22),__webpack_require__(17),__webpack_require__(66),__webpack_require__(26),__webpack_require__(27);var proxyFetch=__webpack_require__(167),curry=__webpack_require__(1067),storage=__webpack_require__(98),api=__webpack_require__(126),__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function sent(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},fetchInstance=proxyFetch.a.getInstance(),proxy=function(method,url){return function(params,settings){return fetchInstance[method](url,params,settings)}};curry.a(proxy)("post"),curry.a(proxy)("get");__webpack_require__.d(__webpack_exports__,"a",(function(){return user_UniUser}));var user_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},user_generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function sent(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},fetching=!1,user_UniUser=function(){function UniUser(){}return UniUser.getInfo=function(){return user_awaiter(this,void 0,void 0,(function(){return user_generator(this,(function(){return console.log("getting user..."),fetching||(fetching=user_awaiter(void 0,void 0,void 0,(function(){var res;return user_generator(this,(function(_a){switch(_a.label){case 0:return console.log("get user from network..."),[4,__awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return console.log("fetching user info..."),[4,__awaiter(void 0,void 0,void 0,(function(){var ex_1;return __generator(this,(function(_a){switch(_a.label){case 0:if(!Object(storage.a)())return[2,!1];_a.label=1;case 1:return _a.trys.push([1,3,,4]),[4,Object(api.a)()];case 2:return _a.sent(),[2,!0];case 3:return ex_1=_a.sent(),console.error(ex_1),[2,!1];case 4:return[2]}}))}))];case 1:return _a.sent()?[4,Object(api.a)()]:[3,3];case 2:return[2,_a.sent()];case 3:return[2,Promise.reject("请先登录！")]}}))}))];case 1:return res=_a.sent(),console.log("res = ",res),[2,res]}}))}))),[2,fetching]}))}))},UniUser.loginByToken=function(){var _this=this;return function(_a){var token=_a.token;return user_awaiter(_this,void 0,void 0,(function(){return user_generator(this,(function(){return Object(storage.b)(token),[2]}))}))}},UniUser.logout=function(){return user_awaiter(this,void 0,void 0,(function(){return user_generator(this,(function(){return UniUser.clearCache(),[2]}))}))},UniUser.clearCache=function(){fetching=!1,console.log("user cached cleared")},UniUser}()},20:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return LOGIN})),__webpack_require__.d(__webpack_exports__,"d",(function(){return LOGOUT})),__webpack_require__.d(__webpack_exports__,"g",(function(){return SET_USER})),__webpack_require__.d(__webpack_exports__,"a",(function(){return LOGGEDIN})),__webpack_require__.d(__webpack_exports__,"b",(function(){return LOGGIN_CANCELLED})),__webpack_require__.d(__webpack_exports__,"f",(function(){return SET_LOADING})),__webpack_require__.d(__webpack_exports__,"e",(function(){return SET_CHECKING}));var LOGIN="LOGIN",LOGOUT="LOGOUT",SET_USER="SET_USER",LOGGEDIN="LOGGEDIN",LOGGIN_CANCELLED="LOGGIN_CANCELLED",SET_LOADING="SET_LOADING",SET_CHECKING="SET_CHECKING"},41:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return login})),__webpack_require__.d(__webpack_exports__,"f",(function(){return setUser})),__webpack_require__.d(__webpack_exports__,"a",(function(){return loggedIn})),__webpack_require__.d(__webpack_exports__,"c",(function(){return loginCancelled})),__webpack_require__.d(__webpack_exports__,"e",(function(){return setLoading})),__webpack_require__.d(__webpack_exports__,"d",(function(){return setChecking}));var _constants_login__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(20),login=function(){return{type:_constants_login__WEBPACK_IMPORTED_MODULE_0__.c}},setUser=function(user){return{type:_constants_login__WEBPACK_IMPORTED_MODULE_0__.g,user:user}},loggedIn=function(token){return{type:_constants_login__WEBPACK_IMPORTED_MODULE_0__.a,token:token}},loginCancelled=function(){return{type:_constants_login__WEBPACK_IMPORTED_MODULE_0__.b}},setLoading=function(loading){return{type:_constants_login__WEBPACK_IMPORTED_MODULE_0__.f,loading:loading}},setChecking=function(checking){return{type:_constants_login__WEBPACK_IMPORTED_MODULE_0__.e,checking:checking}}},544:function(module,exports,__webpack_require__){__webpack_require__(545),__webpack_require__(691),__webpack_require__(692),module.exports=__webpack_require__(693)},609:function(module,exports){},692:function(module,exports){},693:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _storybook_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(528);module._StorybookPreserveDecorators=!0,Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.configure)([__webpack_require__(932)],module)}.call(this,__webpack_require__(427)(module))},932:function(module,exports,__webpack_require__){var map={"./0-Welcome.stories.js":933,"./1-Button.stories.js":939,"./2-LoginStatus.stories.js":1062,"./3-Login.stories.js":1059,"./4-LoginCallback.stories.js":1061};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=932},933:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ToStorybook",(function(){return ToStorybook}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_storybook_addon_links__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(529),_storybook_react_demo__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(85);__webpack_exports__.default={title:"Welcome",component:_storybook_react_demo__WEBPACK_IMPORTED_MODULE_2__.Welcome};var ToStorybook=function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_storybook_react_demo__WEBPACK_IMPORTED_MODULE_2__.Welcome,{showApp:Object(_storybook_addon_links__WEBPACK_IMPORTED_MODULE_1__.linkTo)("Button")})};ToStorybook.story={name:"to Uni Storybook"},ToStorybook.__docgenInfo={description:"",methods:[],displayName:"ToStorybook"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/0-Welcome.stories.js"]={name:"ToStorybook",docgenInfo:ToStorybook.__docgenInfo,path:"stories/0-Welcome.stories.js"})},939:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Text",(function(){return Text})),__webpack_require__.d(__webpack_exports__,"Emoji",(function(){return Emoji}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(379),_storybook_react_demo__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(85);__webpack_exports__.default={title:"Button",component:_storybook_react_demo__WEBPACK_IMPORTED_MODULE_2__.Button};var Text=function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_storybook_react_demo__WEBPACK_IMPORTED_MODULE_2__.Button,{onClick:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_1__.action)("clicked")},"Hello Button")},Emoji=function(){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_storybook_react_demo__WEBPACK_IMPORTED_MODULE_2__.Button,{onClick:Object(_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_1__.action)("clicked")},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",{role:"img","aria-label":"so cool"},"😀 😎 👍 💯"))};Emoji.story={name:"with emoji"},Text.__docgenInfo={description:"",methods:[],displayName:"Text"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/1-Button.stories.js"]={name:"Text",docgenInfo:Text.__docgenInfo,path:"stories/1-Button.stories.js"}),Emoji.__docgenInfo={description:"",methods:[],displayName:"Emoji"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/1-Button.stories.js"]={name:"Emoji",docgenInfo:Emoji.__docgenInfo,path:"stories/1-Button.stories.js"})},98:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getAccessToken})),__webpack_require__.d(__webpack_exports__,"b",(function(){return setAccessToken}));var getAccessToken=function(){return JSON.parse(window.localStorage.getItem("gatsbyAccessToken"))},setAccessToken=function(token){return window.localStorage.setItem("gatsbyAccessToken",JSON.stringify(token))}},985:function(module,exports){module.exports={messagesForLogin:{}}}},[[544,1,2]]]);
//# sourceMappingURL=main.aca6448aaaa0f4ed4b2a.bundle.js.map